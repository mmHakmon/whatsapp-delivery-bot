# ðŸšš M.M.H Delivery System

×ž×¢×¨×›×ª × ×™×”×•×œ ×ž×©×œ×•×—×™× ×ž×ª×§×“×ž×ª ×¢× ××•×˜×•×ž×¦×™×” ×ž×œ××”, ×ž×¢×§×‘ ×‘×–×ž×Ÿ ××ž×ª ×•××™× ×˜×’×¨×¦×™×™×ª WhatsApp.

![Version](https://img.shields.io/badge/version-1.0.0-blue.svg)
![Node](https://img.shields.io/badge/node-%3E%3D18.0.0-green.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

---

## ðŸ“‹ ×ª×•×›×Ÿ ×¢× ×™×™× ×™×

- [×ª×›×•× ×•×ª](#-×ª×›×•× ×•×ª)
- [×“×¨×™×©×•×ª ×ž×¢×¨×›×ª](#-×“×¨×™×©×•×ª-×ž×¢×¨×›×ª)
- [×”×ª×§× ×”](#-×”×ª×§× ×”)
- [×”×’×“×¨×•×ª](#-×”×’×“×¨×•×ª)
- [×”×¨×¦×”](#-×”×¨×¦×”)
- [×ž×‘× ×” ×”×¤×¨×•×™×§×˜](#-×ž×‘× ×”-×”×¤×¨×•×™×§×˜)
- [API Documentation](#-api-documentation)
- [Deployment](#-deployment)
- [×ª×—×–×•×§×”](#-×ª×—×–×•×§×”)

---

## âœ¨ ×ª×›×•× ×•×ª

### ðŸŽ¯ ×ª×›×•× ×•×ª ×¢×™×§×¨×™×•×ª
- âœ… **×ž×¢×¨×›×ª ×”×–×ž× ×•×ª ×ž×œ××”** - ×™×¦×™×¨×”, ×¢×¨×™×›×”, ×ž×¢×§×‘ ×•×‘×™×˜×•×œ
- âœ… **× ×™×”×•×œ ×©×œ×™×—×™×** - ×¨×™×©×•×, ××™×©×•×¨, ×—×¡×™×ž×” ×•×ª×©×œ×•×ž×™×
- âœ… **×—×™×©×•×‘ ×ž×—×™×¨×™× ××•×˜×•×ž×˜×™** - Google Maps Distance Matrix API
- âœ… **WhatsApp ××•×˜×•×ž×˜×™** - ×”×ª×¨××•×ª ×œ×œ×§×•×—×•×ª ×•×©×œ×™×—×™× ×“×¨×š Whapi.cloud
- âœ… **WebSocket Real-time** - ×¢×“×›×•× ×™× ×—×™×™× ×œ×›×œ ×”×ž×©×ª×ž×©×™×
- âœ… **GPS Tracking** - ×ž×¢×§×‘ ××—×¨ ×ž×™×§×•× ×©×œ×™×—×™× ×‘×–×ž×Ÿ ××ž×ª
- âœ… **×ž×¢×¨×›×ª ×ª×©×œ×•×ž×™×** - × ×™×”×•×œ ×™×ª×¨×•×ª ×•×‘×§×©×•×ª ×ž×©×™×›×”
- âœ… **×“×©×‘×•×¨×“ ×× ×œ×™×˜×™** - ×¡×˜×˜×™×¡×˜×™×§×•×ª ×•×“×•×—×•×ª ×ž×¤×•×¨×˜×™×

### ðŸ¢ ×œ×ž× ×”×œ×™×
- ×“×©×‘×•×¨×“ ×ž×¨×›×–×™ ×¢× ×¡×˜×˜×™×¡×˜×™×§×•×ª
- × ×™×”×•×œ ×”×–×ž× ×•×ª (×™×¦×™×¨×”, ×¤×¨×¡×•×, ×‘×™×˜×•×œ)
- × ×™×”×•×œ ×©×œ×™×—×™× (××™×©×•×¨, ×—×¡×™×ž×”)
- ××™×©×•×¨ ×ª×©×œ×•×ž×™× ×œ×©×œ×™×—×™×
- ×™×¦×•× × ×ª×•× ×™× ×•×“×•×—×•×ª

### ðŸï¸ ×œ×©×œ×™×—×™×
- ××¤×œ×™×§×¦×™×” ×¤×©×•×˜×” ×•× ×•×—×”
- ×”×ª×—×‘×¨×•×ª ×¢× ×ž×¡×¤×¨ ×˜×œ×¤×•×Ÿ ×‘×œ×‘×“
- ×¨×©×™×ž×ª ×ž×©×œ×•×—×™× ×–×ž×™× ×™×
- × ×™×”×•×œ ×ž×©×œ×•×—×™× ×¤×¢×™×œ×™×
- ×“×©×‘×•×¨×“ ×¨×•×•×—×™× ×•×‘×§×©×•×ª ×ž×©×™×›×”
- × ×™×•×•×˜ ××•×˜×•×ž×˜×™ ×œ-Waze

### ðŸ‘¤ ×œ×œ×§×•×—×•×ª
- ×˜×•×¤×¡ ×”×–×ž× ×” ×¤×©×•×˜
- ×—×™×©×•×‘ ×ž×—×™×¨ ×ž×™×™×“×™
- ×ž×¢×§×‘ ××—×¨ ×ž×©×œ×•×— ×‘×–×ž×Ÿ ××ž×ª
- ×”×ª×¨××•×ª WhatsApp ××•×˜×•×ž×˜×™×•×ª
- ×“×™×¨×•×’ ×©×œ×™×—×™×

---

## ðŸ”§ ×“×¨×™×©×•×ª ×ž×¢×¨×›×ª

### ×ª×•×›× ×” × ×“×¨×©×ª
- **Node.js** >= 18.0.0
- **PostgreSQL** >= 15
- **npm** ××• **yarn**

### ×©×™×¨×•×ª×™× ×—×™×¦×•× ×™×™×
- **Google Maps API** - ×—×™×©×•×‘ ×ž×¨×—×§×™×
- **Whapi.cloud** - ×©×œ×™×—×ª ×”×•×“×¢×•×ª WhatsApp
- **Render.com** (××• hosting ×“×•×ž×”) - deployment

---

## ðŸ“¦ ×”×ª×§× ×”

### 1. Clone ×”×¤×¨×•×™×§×˜
```bash
git clone https://github.com/yourusername/mmh-delivery.git
cd mmh-delivery
```

### 2. ×”×ª×§× ×ª Dependencies
```bash
npm install
```

### 3. ×”×’×“×¨×ª Environment Variables

×”×¢×ª×§ ××ª ×§×•×‘×¥ `.env.example` ×œ-`.env`:
```bash
cp .env.example .env
```

×¢×¨×•×š ××ª ×”×§×•×‘×¥ `.env` ×•×”×–×Ÿ ××ª ×”×¢×¨×›×™× ×©×œ×š:
```bash
# ×“××˜××‘×™×™×¡
DATABASE_URL=postgresql://user:password@localhost:5432/mmh_delivery

# JWT Secrets (×¦×•×¨ secrets ×—×–×§×™×!)
JWT_SECRET=your-generated-secret-key
JWT_REFRESH_SECRET=your-generated-refresh-key

# WhatsApp
WHAPI_TOKEN=your-whapi-token
COURIERS_GROUP_ID=your-group-id

# Google Maps
GOOGLE_API_KEY=your-google-api-key
```

### 4. ×™×¦×™×¨×ª ×‘×¡×™×¡ × ×ª×•× ×™×
```bash
# ×”×ª×—×‘×¨ ×œ-PostgreSQL
psql -U postgres

# ×¦×•×¨ database
CREATE DATABASE mmh_delivery;
\q

# ×”×¨×¥ ××ª ×¡×§×¨×™×¤×˜ ×”×™×¦×™×¨×”
npm run init-db
```

---

## âš™ï¸ ×”×’×“×¨×•×ª

### ×ž×—×™×¨×•×Ÿ

×¢×¨×•×š ××ª ×”×ž×—×™×¨×™× ×‘-`.env`:
```bash
MOTORCYCLE_BASE_PRICE=70      # ×ž×—×™×¨ ×‘×¡×™×¡ ××•×¤× ×•×¢
MOTORCYCLE_PRICE_PER_KM=2.5   # ×ž×—×™×¨ ×œ×§"×ž

CAR_BASE_PRICE=75
CAR_PRICE_PER_KM=2.5

VAN_BASE_PRICE=120
VAN_PRICE_PER_KM=3.0

TRUCK_BASE_PRICE=200
TRUCK_PRICE_PER_KM=4.0

FREE_KM=1                     # ×§"×ž ×¨××©×•×Ÿ ×—×™× ×
VAT_RATE=0.18                 # ×ž×¢"×ž 18%
COMMISSION_RATE=0.25          # ×¢×ž×œ×” 25%
```

### ×ž×©×ª×ž×© ×ž× ×”×œ ×‘×¨×™×¨×ª ×ž×—×“×œ

×œ××—×¨ `npm run init-db`:
```
Username: admin
Password: Admin123!
```

**×—×©×•×‘:** ×©× ×” ××ª ×”×¡×™×¡×ž×” ×ž×™×“ ×œ××—×¨ ×”×”×ª×—×‘×¨×•×ª ×”×¨××©×•× ×”!

---

## ðŸš€ ×”×¨×¦×”

### Development Mode
```bash
npm run dev
```

×”×©×¨×ª ×™×¨×•×¥ ×¢×œ: `http://localhost:10000`

### Production Mode
```bash
npm start
```

### ×“×¤×™× ×–×ž×™× ×™×

- **Admin Panel**: http://localhost:10000/admin
- **Courier App**: http://localhost:10000/courier
- **Customer Form**: http://localhost:10000/
- **Health Check**: http://localhost:10000/health

---

## ðŸ“ ×ž×‘× ×” ×”×¤×¨×•×™×§×˜
```
mmh-delivery/
â”œâ”€â”€ server.js                 # × ×§×•×“×ª ×›× ×™×¡×” ×¨××©×™×ª
â”œâ”€â”€ package.json
â”œâ”€â”€ .env
â”œâ”€â”€ .gitignore
â”‚
â”œâ”€â”€ config/                   # ×”×’×“×¨×•×ª
â”‚   â”œâ”€â”€ database.js          # ×—×™×‘×•×¨ PostgreSQL
â”‚   â”œâ”€â”€ constants.js         # ×§×‘×•×¢×™×
â”‚   â””â”€â”€ pricing.js           # ×œ×•×’×™×§×ª ×ª×ž×—×•×¨
â”‚
â”œâ”€â”€ middleware/              # Middleware
â”‚   â”œâ”€â”€ auth.js             # JWT authentication
â”‚   â”œâ”€â”€ validation.js       # Validation rules
â”‚   â””â”€â”€ errorHandler.js     # Error handling
â”‚
â”œâ”€â”€ routes/                  # Routes
â”‚   â”œâ”€â”€ auth.routes.js
â”‚   â”œâ”€â”€ orders.routes.js
â”‚   â”œâ”€â”€ couriers.routes.js
â”‚   â”œâ”€â”€ payments.routes.js
â”‚   â””â”€â”€ admin.routes.js
â”‚
â”œâ”€â”€ controllers/             # Controllers
â”‚   â”œâ”€â”€ auth.controller.js
â”‚   â”œâ”€â”€ orders.controller.js
â”‚   â”œâ”€â”€ couriers.controller.js
â”‚   â””â”€â”€ payments.controller.js
â”‚
â”œâ”€â”€ services/                # Services
â”‚   â”œâ”€â”€ whatsapp.service.js # WhatsApp
â”‚   â”œâ”€â”€ maps.service.js     # Google Maps
â”‚   â””â”€â”€ websocket.service.js # Real-time
â”‚
â”œâ”€â”€ utils/                   # Utilities
â”‚   â”œâ”€â”€ helpers.js
â”‚   â””â”€â”€ logger.js
â”‚
â”œâ”€â”€ database/                # Database
â”‚   â”œâ”€â”€ init.sql
â”‚   â””â”€â”€ init.js
â”‚
â””â”€â”€ public/                  # Frontend
    â”œâ”€â”€ index.html          # Customer form
    â”œâ”€â”€ admin/
    â”‚   â”œâ”€â”€ index.html
    â”‚   â””â”€â”€ admin.js
    â””â”€â”€ courier/
        â”œâ”€â”€ index.html
        â””â”€â”€ courier.js
```

---

## ðŸ“š API Documentation

### Authentication

#### POST `/api/auth/login`
×”×ª×—×‘×¨×•×ª ×ž× ×”×œ
```json
{
  "username": "admin",
  "password": "Admin123!"
}
```

#### POST `/api/auth/courier-login`
×”×ª×—×‘×¨×•×ª ×©×œ×™×—
```json
{
  "phone": "0501234567"
}
```

### Orders

#### GET `/api/orders`
×¨×©×™×ž×ª ×”×–×ž× ×•×ª (×“×•×¨×© ××™×ž×•×ª)

Query params:
- `status`: new, published, taken, picked, delivered, cancelled
- `limit`: ×ž×¡×¤×¨ ×ª×•×¦××•×ª (default: 50)
- `offset`: offset ×œ×“×¤×“×•×£

#### POST `/api/orders`
×™×¦×™×¨×ª ×”×–×ž× ×” ×—×“×©×” (×“×•×¨×© ××™×ž×•×ª)
```json
{
  "senderName": "×©× ×©×•×œ×—",
  "senderPhone": "0501234567",
  "pickupAddress": "×›×ª×•×‘×ª ××™×¡×•×£",
  "receiverName": "×©× ×ž×§×‘×œ",
  "receiverPhone": "0509876543",
  "deliveryAddress": "×›×ª×•×‘×ª ×ž×¡×™×¨×”",
  "vehicleType": "motorcycle",
  "packageDescription": "×ª×™××•×¨"
}
```

#### POST `/api/orders/:id/publish`
×¤×¨×¡×•× ×”×–×ž× ×” (×“×•×¨×© ××™×ž×•×ª admin)

#### POST `/api/orders/:id/take`
×ª×¤×™×¡×ª ×”×–×ž× ×” (×“×•×¨×© ××™×ž×•×ª courier)

#### POST `/api/orders/:id/pickup`
×¡×™×ž×•×Ÿ ×›× ××¡×£ (×“×•×¨×© ××™×ž×•×ª courier)

#### POST `/api/orders/:id/deliver`
×¡×™×ž×•×Ÿ ×›× ×ž×¡×¨ (×“×•×¨×© ××™×ž×•×ª courier)

### Couriers

#### GET `/api/couriers`
×¨×©×™×ž×ª ×©×œ×™×—×™× (×“×•×¨×© ××™×ž×•×ª admin)

#### POST `/api/couriers/register`
×¨×™×©×•× ×©×œ×™×— ×—×“×©
```json
{
  "firstName": "×™×•×¡×™",
  "lastName": "×›×”×Ÿ",
  "idNumber": "123456789",
  "phone": "0501234567",
  "vehicleType": "motorcycle"
}
```

#### GET `/api/couriers/available-orders`
×ž×©×œ×•×—×™× ×–×ž×™× ×™× (×“×•×¨×© ××™×ž×•×ª courier)

#### GET `/api/couriers/my-statistics`
×¡×˜×˜×™×¡×˜×™×§×•×ª ×©×œ×™×— (×“×•×¨×© ××™×ž×•×ª courier)

### Payments

#### POST `/api/payments/payout-request`
×‘×§×©×ª ×ž×©×™×›×” (×“×•×¨×© ××™×ž×•×ª courier)
```json
{
  "amount": 500,
  "paymentMethod": "bank_transfer",
  "accountInfo": "12-345-67890"
}
```

#### GET `/api/payments/requests`
×¨×©×™×ž×ª ×‘×§×©×•×ª ×ž×©×™×›×” (×“×•×¨×© ××™×ž×•×ª admin)

#### POST `/api/payments/requests/:id/approve`
××™×©×•×¨ ×‘×§×©×ª ×ž×©×™×›×” (×“×•×¨×© ××™×ž×•×ª admin)

---

## ðŸŒ Deployment

### Render.com (×ž×•×ž×œ×¥)

1. **×¦×•×¨ Web Service ×—×“×©**
   - Repository: ×”×—×™×‘×•×¨ ×œ-GitHub
   - Build Command: `npm install`
   - Start Command: `npm start`

2. **×¦×•×¨ PostgreSQL Database**
   - ×”×•×¡×£ ××ª ×”-`DATABASE_URL` ×œ-Environment Variables

3. **×”×’×“×¨ Environment Variables**
   - ×”×¢×ª×§ ××ª ×›×œ ×”×ž×©×ª× ×™× ×ž-`.env`
   - ×”×•×¡×£ ××•×ª× ×‘-Render Dashboard

4. **Deploy!**
   - Render ×™×‘×¦×¢ deploy ××•×˜×•×ž×˜×™×ª

### Railway / Heroku

×“×•×ž×” ×œ-Render, ×¨×§ ×”×§×¤×“ ×¢×œ:
- Build Pack: Node.js
- PostgreSQL add-on
- Environment Variables

---

## ðŸ”’ ××‘×˜×—×”

### Best Practices

âœ… **JWT Tokens**
- Access token: 15 ×“×§×•×ª
- Refresh token: 7 ×™×•×
- Secrets ×—×–×§×™× ×‘×œ×‘×“

âœ… **Passwords**
- bcrypt ×¢× 12 rounds
- ×ž×™× ×™×ž×•× 8 ×ª×•×•×™×
- Never log passwords

âœ… **Rate Limiting**
- 100 requests/minute global
- 5 login attempts/minute

âœ… **Database**
- Parameterized queries (×ž×•× ×¢ SQL injection)
- SSL ×‘×¡×‘×™×‘×ª production

âœ… **Headers**
- Helmet.js ×œ××‘×˜×—×ª headers
- CORS configuration

---

## ðŸ”„ ×ª×—×–×•×§×”

### Logs

Logs × ×©×ž×¨×™× ×‘×ª×™×§×™×™×ª `/logs`:
```bash
# ×¦×¤×™×™×” ×‘-logs
tail -f logs/$(date +%Y-%m-%d).log
```

### Backup Database
```bash
# ×’×™×‘×•×™
pg_dump -U postgres mmh_delivery > backup.sql

# ×©×—×–×•×¨
psql -U postgres mmh_delivery < backup.sql
```

### ×¢×“×›×•×Ÿ Dependencies
```bash
# ×‘×“×™×§×ª ×¢×“×›×•× ×™×
npm outdated

# ×¢×“×›×•×Ÿ
npm update

# ×¢×“×›×•×Ÿ major versions
npm install package@latest
```

---

## ðŸ› Troubleshooting

### Database Connection Error
```
Error: connect ECONNREFUSED
```

**×¤×ª×¨×•×Ÿ:**
- ×‘×“×•×§ ×©-PostgreSQL ×¨×¥: `sudo service postgresql status`
- ×‘×“×•×§ ××ª `DATABASE_URL` ×‘-`.env`

### WhatsApp Not Sending

**×¤×ª×¨×•×Ÿ:**
- ×‘×“×•×§ ××ª `WHAPI_TOKEN` ×ª×§×£
- ×‘×“×•×§ ××ª `COURIERS_GROUP_ID` × ×›×•×Ÿ
- ×¦×¤×” ×‘-console logs

### Google Maps Error

**×¤×ª×¨×•×Ÿ:**
- ×‘×“×•×§ ×©-Distance Matrix API ×ž×•×¤×¢×œ
- ×‘×“×•×§ credit ×‘-Google Cloud Console
- ×‘×“×•×§ ××ª `GOOGLE_API_KEY`

---

## ðŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª

×ž×¢×¨×›×ª ×ª×•×ž×›×ª ×‘:
- 1000+ ×ž×©×œ×•×—×™× ×‘×™×•×
- 100+ ×©×œ×™×—×™× ×¤×¢×™×œ×™×
- Real-time updates ×œ-1000+ ×ž×©×ª×ž×©×™×
- <2 ×©× ×™×•×ª ×–×ž×Ÿ ×ª×’×•×‘×”

---

## ðŸ¤ ×ª×¨×•×ž×”

×¨×•×¦×” ×œ×ª×¨×•×? × ×”×“×¨!

1. Fork the repo
2. Create feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Open Pull Request

---

## ðŸ“ License

MIT License - ×¨××” [LICENSE](LICENSE) ×œ×¤×¨×˜×™×

---

## ðŸ‘¨â€ðŸ’» ×™×•×¦×¨

**Haki** - M.M.H Delivery System

- GitHub: [@yourusername](https://github.com/yourusername)
- Email: your.email@example.com

---

## ðŸ™ ×ª×•×“×•×ª

- [Express.js](https://expressjs.com/)
- [PostgreSQL](https://www.postgresql.org/)
- [Tailwind CSS](https://tailwindcss.com/)
- [Google Maps API](https://developers.google.com/maps)
- [Whapi.cloud](https://whapi.cloud/)
- [Render.com](https://render.com/)

---

**×¢×©×•×™ ×¢× â¤ï¸ ×‘×™×©×¨××œ**