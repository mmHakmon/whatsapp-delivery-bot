<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××—×©×‘×•×Ÿ ××—×™×¨×™× - M.M.H Delivery</title>
    <link rel="icon" href="/assets/logo.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800&display=swap');

        :root {
            --bg: #0f172a;
            --card: #1e293b;
            --card-hover: #334155;
            --border: #334155;
            --accent: #10b981;
            --accent-hover: #059669;
            --accent-dim: rgba(16,185,129,0.1);
            --text: #f1f5f9;
            --text-sec: #94a3b8;
            --text-mute: #64748b;
            --input-bg: #0f172a;
            --red: #ef4444;
        }

        * { margin:0; padding:0; box-sizing:border-box; }

        body {
            font-family: 'Heebo', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        /* HEADER */
        header {
            background: var(--card);
            border-bottom: 1px solid var(--border);
            padding: 14px 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        header img { height: 40px; }
        header .hdr-text h1 { font-size: 17px; font-weight: 700; }
        header .hdr-text p { font-size: 11px; color: var(--text-mute); }

        /* LAYOUT */
        .wrap {
            max-width: 720px;
            margin: 0 auto;
            padding: 28px 18px 70px;
        }

        .page-head {
            text-align: center;
            margin-bottom: 28px;
        }
        .page-head h2 { font-size: 24px; font-weight: 800; }
        .page-head p { color: var(--text-sec); font-size: 13px; margin-top: 4px; }

        /* STEP */
        .step-lbl {
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 1.4px;
            text-transform: uppercase;
            color: var(--accent);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 7px;
        }
        .step-lbl .sn {
            background: var(--accent);
            color:#fff;
            width: 18px; height: 18px;
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; font-weight: 800;
        }

        /* CARD */
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 16px;
        }

        /* ===== DELIVERY TYPE GRID ===== */
        .type-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
        }
        .type-btn {
            background: var(--input-bg);
            border: 1.5px solid var(--border);
            border-radius: 10px;
            padding: 13px 11px 11px;
            cursor: pointer;
            transition: all 0.15s;
            position: relative;
            text-align: right;
        }
        .type-btn:hover { border-color: var(--accent); background: var(--accent-dim); }
        .type-btn.active {
            border-color: var(--accent);
            background: var(--accent-dim);
        }
        .type-btn .t-icon { font-size: 18px; margin-bottom: 3px; }
        .type-btn .t-name { font-size: 13px; font-weight: 600; }
        .type-btn .t-price { font-size: 11px; color: var(--text-mute); margin-top: 2px; }
        .type-btn .t-price span { color: var(--accent); font-weight: 700; }
        .type-btn .t-chk {
            position: absolute; top: 9px; left: 9px;
            width: 18px; height: 18px; border-radius: 50%;
            border: 2px solid var(--border);
            background: transparent;
            transition: all 0.15s;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; color: #fff;
        }
        .type-btn.active .t-chk {
            background: var(--accent);
            border-color: var(--accent);
        }
        .type-btn.active .t-chk::after { content:'âœ“'; }

        /* ===== VEHICLE GRID ===== */
        .vehicle-section { display: none; margin-top: 14px; }
        .vehicle-section.visible { display: block; }
        .vehicle-section .sub-lbl {
            font-size: 12px; color: var(--text-sec); font-weight: 600; margin-bottom: 8px;
        }
        .vehicle-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 7px;
        }
        .veh-btn {
            background: var(--input-bg);
            border: 1.5px solid var(--border);
            border-radius: 9px;
            padding: 12px 4px;
            cursor: pointer;
            text-align: center;
            transition: all 0.15s;
        }
        .veh-btn:hover { border-color: var(--accent); background: var(--accent-dim); }
        .veh-btn.active { border-color: var(--accent); background: var(--accent-dim); }
        .veh-btn .vi { font-size: 20px; }
        .veh-btn .vn { font-size: 11px; font-weight: 600; margin-top: 3px; color: var(--text); }
        .veh-btn .vp { font-size: 10px; color: var(--accent); font-weight: 700; margin-top: 1px; }

        /* ===== PACKAGING GRID ===== */
        .pack-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 7px;
        }
        .pack-btn {
            background: var(--input-bg);
            border: 1.5px solid var(--border);
            border-radius: 9px;
            padding: 11px;
            cursor: pointer;
            display: flex; align-items: center; gap: 10px;
            transition: all 0.15s;
        }
        .pack-btn:hover { border-color: var(--accent); background: var(--accent-dim); }
        .pack-btn.active { border-color: var(--accent); background: var(--accent-dim); }
        .pack-btn .pi { font-size: 18px; }
        .pack-btn .pn { font-size: 12px; font-weight: 600; color: var(--text); }
        .pack-btn .pp { font-size: 11px; color: var(--text-mute); margin-top: 1px; }
        .pack-btn .pp span { color: var(--accent); font-weight: 700; }
        .pack-desc {
            margin-top: 10px;
            font-size: 11px;
            color: var(--text-mute);
            font-style: italic;
            text-align: center;
        }

        /* ===== ADDRESS INPUTS ===== */
        .addr-row { display: flex; flex-direction: column; gap: 10px; }
        .addr-block label {
            display: block;
            font-size: 12px; font-weight: 600; color: var(--text-sec);
            margin-bottom: 5px;
        }
        .addr-block input {
            width: 100%;
            background: var(--input-bg);
            border: 1.5px solid var(--border);
            border-radius: 9px;
            padding: 11px 13px;
            color: var(--text);
            font-size: 14px;
            font-family: 'Heebo', sans-serif;
            outline: none;
            transition: border-color 0.2s;
        }
        .addr-block input:focus { border-color: var(--accent); }
        .addr-block input::placeholder { color: var(--text-mute); }

        /* Google autocomplete dark styling */
        .pac-container {
            background-color: #1e293b !important;
            border: 1px solid #475569 !important;
            border-radius: 8px;
            font-family: 'Heebo', sans-serif;
            z-index: 99999 !important;
        }
        .pac-item { color: #e2e8f0 !important; padding: 8px; border-top: 1px solid #475569 !important; cursor: pointer; }
        .pac-item:hover { background-color: #334155 !important; }
        .pac-item-query { color: #10b981 !important; font-weight: bold; }
        .pac-icon { display: none; }

        /* ===== CALC BUTTON ===== */
        .calc-btn {
            width: 100%;
            background: var(--accent);
            color: #fff;
            border: none;
            border-radius: 11px;
            padding: 15px;
            font-size: 15px;
            font-weight: 700;
            font-family: 'Heebo', sans-serif;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
            margin-top: 6px;
            display: flex; align-items: center; justify-content: center; gap: 7px;
        }
        .calc-btn:hover { background: var(--accent-hover); }
        .calc-btn:active { transform: scale(0.98); }
        .calc-btn:disabled { background: var(--card-hover); color: var(--text-mute); cursor: not-allowed; }

        /* SPINNER */
        .spinner {
            width: 16px; height: 16px;
            border: 2.5px solid rgba(255,255,255,0.3);
            border-top-color: #fff;
            border-radius: 50%;
            animation: spin 0.55s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ===== RESULT PANEL ===== */
        .result-panel {
            display: none;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 14px;
            overflow: hidden;
            margin-top: 14px;
        }
        .result-panel.visible { display: block; animation: fadeUp 0.3s ease; }
        @keyframes fadeUp {
            from { opacity:0; transform: translateY(8px); }
            to   { opacity:1; transform: translateY(0); }
        }

        .res-header {
            background: var(--accent);
            padding: 14px 18px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .res-header .rh-label { font-size: 13px; font-weight: 600; }
        .res-header .rh-total { font-size: 24px; font-weight: 800; }

        .res-body { padding: 16px 18px; }
        .res-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
            font-size: 13px;
        }
        .res-row:last-child { border-bottom: none; }
        .res-row .rl { color: var(--text-sec); }
        .res-row .rv { color: var(--text); font-weight: 600; }
        .res-row.subtotal-row .rl { color: var(--text); font-weight: 600; }
        .res-row.subtotal-row .rv { color: var(--accent); font-size: 15px; }
        .res-row.vat .rl, .res-row.vat .rv { color: var(--text-mute); font-size: 12px; }

        /* ERROR */
        .error-box {
            display: none;
            background: rgba(239,68,68,0.12);
            border: 1px solid var(--red);
            border-radius: 9px;
            padding: 12px 14px;
            color: #fca5a5;
            font-size: 13px;
            margin-top: 10px;
        }
        .error-box.visible { display: block; }

        /* RESPONSIVE */
        @media (max-width: 500px) {
            .type-grid { grid-template-columns: 1fr 1fr; }
            .vehicle-grid { grid-template-columns: repeat(2, 1fr); }
            .pack-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header>
    <img src="/assets/logo.png" alt="MMH">
    <div class="hdr-text">
        <h1>M.M.H Delivery</h1>
        <p>××—×©×‘×•×Ÿ ××—×™×¨×™×</p>
    </div>
</header>

<div class="wrap">
    <div class="page-head">
        <h2>××—×©×‘×•×Ÿ ××—×™×¨×™×</h2>
        <p>×‘×—×¨ ×¡×•×’ ××©×œ×•×—, ×”×›× ×¡ ×›×ª×•×‘×•×ª ×•×§×‘×œ ××—×™×¨ ×œ××œ×ª×¨</p>
    </div>

    <!-- STEP 1 -->
    <div class="step-lbl"><span class="sn">1</span> ×‘×—×¨ ×¡×•×’ ××©×œ×•×—</div>
    <div class="card">
        <div class="type-grid" id="typeGrid"></div>
        <div class="vehicle-section" id="vehicleSection">
            <div class="sub-lbl">×‘×—×¨ ×¡×•×’ ×¨×›×‘:</div>
            <div class="vehicle-grid" id="vehicleGrid"></div>
        </div>
    </div>

    <!-- STEP 2 -->
    <div id="packagingStep">
        <div class="step-lbl"><span class="sn">2</span> ××¨×™×–×”</div>
        <div class="card">
            <div class="pack-grid" id="packGrid"></div>
            <div class="pack-desc" id="packDesc">×œ×œ× ×©×™×¨×•×ª×™ ××¨×™×–×”</div>
        </div>
    </div>

    <!-- STEP 3 -->
    <div class="step-lbl" id="addrStepLbl"><span class="sn">3</span> ×›×ª×•×‘×•×ª</div>
    <div class="card">
        <div class="addr-row">
            <div class="addr-block">
                <label>ğŸ“ ×›×ª×•×‘×ª ××™×¡×•×£</label>
                <input type="text" id="origin" placeholder="×œ×“×•×’××”: ×ª×œ ××‘×™×‘, ×¨×—×•×‘ ×”×¨×¦×œ 1">
            </div>
            <div class="addr-block">
                <label>ğŸ  ×›×ª×•×‘×ª ×™×¢×“</label>
                <input type="text" id="destination" placeholder="×œ×“×•×’××”: ×™×¨×•×©×œ×™×, ×¨×—×•×‘ ×™×¤×• 23">
            </div>
        </div>
    </div>

    <button class="calc-btn" id="calcBtn" onclick="calculate()">×—×©×‘ ××—×™×¨</button>
    <div class="error-box" id="errorBox"></div>

    <!-- RESULT -->
    <div class="result-panel" id="resultPanel">
        <div class="res-header">
            <span class="rh-label">××—×™×¨ ×›×•×œ×œ ××¢"×</span>
            <span class="rh-total" id="totalPrice">â‚ª0</span>
        </div>
        <div class="res-body" id="resBody"></div>
    </div>
</div>

<script>
// ==========================================
// DATA
// ==========================================
const DELIVERY_TYPES = [
    { id:'express',   icon:'ğŸï¸',  name:'××§×¡×¤×¨×¡',              base:70,  includedKm:0,  perKm:3,   hasVehicle:true  },
    { id:'legal',     icon:'âš–ï¸',  name:'××¡×™×¨×” ××©×¤×˜×™×ª',        base:350, includedKm:30, perKm:0.5, hasVehicle:false },
    { id:'apostille', icon:'ğŸ“œ',  name:'××¤×•×¡×˜×™×œ',             base:200, includedKm:10, perKm:0.5, hasVehicle:false },
    { id:'taboo',     icon:'ğŸ›ï¸',  name:'×¨×©× ××§×¨×§×¢×™×Ÿ (×˜××‘×•)',  base:200, includedKm:10, perKm:0.5, hasVehicle:false },
    { id:'company',   icon:'ğŸ¢',  name:'×¨×©× ×—×‘×¨×•×ª ×•×¢××•×ª×•×ª',   base:200, includedKm:10, perKm:0.5, hasVehicle:false },
    { id:'pension',   icon:'ğŸ’¼',  name:'×¨×©× ××¡×›×•× ×•×ª',         base:200, includedKm:10, perKm:0.5, hasVehicle:false },
    { id:'inherit',   icon:'ğŸ“‹',  name:'×¨×©× ×™×¨×•×©×•×ª',          base:200, includedKm:10, perKm:0.5, hasVehicle:false }
];

const VEHICLES = [
    { id:'motorcycle', icon:'ğŸï¸', name:'××•×¤× ×•×¢',  base:70,  perKm:3 },
    { id:'car',        icon:'ğŸš—', name:'×¨×›×‘',      base:100, perKm:3 },
    { id:'van',        icon:'ğŸš', name:'××¡×—×¨×™×ª',  base:320, perKm:3.5 },
    { id:'truck',      icon:'ğŸšš', name:'××©××™×ª',   base:900, perKm:4 }
];

const PACKAGING = [
    { id:'none',         icon:'ğŸ“¦',   name:'×œ×œ× ××¨×™×–×”',      price:0,   desc:'×œ×œ× ×©×™×¨×•×ª×™ ××¨×™×–×”' },
    { id:'basic',        icon:'ğŸ“¦âœ¨',  name:'××¨×™×–×” ×¨×’×™×œ×”',    price:50,  desc:'×§×¨×˜×•× ×™×, ×¡×œ×•×˜×™×™×¤ ×•×—×•××¨×™ ××¨×™×–×” ×‘×¡×™×¡×™×™×' },
    { id:'enhanced',     icon:'ğŸ“¦ğŸ›¡ï¸', name:'××¨×™×–×” ××•×’×‘×¨×ª',   price:100, desc:'×‘×•×¢×•×ª ××•×•×™×¨, ×§×¨×˜×•× ×™× ××—×•×–×§×™×, ×¨×™×¤×•×“ ××™×•×—×“' },
    { id:'professional', icon:'ğŸ“¦ğŸ’', name:'××¨×™×–×” ××§×¦×•×¢×™×ª',  price:150, desc:'××¨×™×–×” ××§×¦×•×¢×™×ª ×œ×¦×™×•×“ ×©×‘×™×¨ / ×¨×¤×•××™ / ×™×§×¨ ×¢×¨×š' }
];

const VAT = 0.18;

// ==========================================
// STATE
// ==========================================
let selectedType    = 'express';
let selectedVehicle = 'motorcycle';
let selectedPacking = 'none';

// ==========================================
// RENDER
// ==========================================
function renderTypes() {
    document.getElementById('typeGrid').innerHTML = DELIVERY_TYPES.map(t => `
        <div class="type-btn ${t.id === selectedType ? 'active' : ''}" onclick="selectType('${t.id}')">
            <div class="t-chk"></div>
            <div class="t-icon">${t.icon}</div>
            <div class="t-name">${t.name}</div>
            <div class="t-price">×‘×¡×™×¡ <span>â‚ª${t.base}</span>${t.includedKm > 0 ? ` Â· ×›×•×œ×œ ${t.includedKm} ×§"×` : ''}</div>
        </div>
    `).join('');
}

function renderVehicles() {
    document.getElementById('vehicleGrid').innerHTML = VEHICLES.map(v => `
        <div class="veh-btn ${v.id === selectedVehicle ? 'active' : ''}" onclick="selectVehicle('${v.id}')">
            <div class="vi">${v.icon}</div>
            <div class="vn">${v.name}</div>
            <div class="vp">â‚ª${v.base}</div>
        </div>
    `).join('');
}

function renderPackaging() {
    document.getElementById('packGrid').innerHTML = PACKAGING.map(p => `
        <div class="pack-btn ${p.id === selectedPacking ? 'active' : ''}" onclick="selectPacking('${p.id}')">
            <div class="pi">${p.icon}</div>
            <div class="pn">${p.name}</div>
            <div class="pp"><span>â‚ª${p.price}</span></div>
        </div>
    `).join('');
    document.getElementById('packDesc').textContent = PACKAGING.find(p => p.id === selectedPacking).desc;
}

function updateLayout() {
    const type = DELIVERY_TYPES.find(t => t.id === selectedType);

    // Vehicle sub-selector: only for express
    document.getElementById('vehicleSection').classList.toggle('visible', type.hasVehicle);

    // Packaging step: only for express
    const packStep = document.getElementById('packagingStep');
    packStep.style.display = type.hasVehicle ? 'block' : 'none';

    // Address step number: 3 if packaging shown, else 2
    const addrLbl = document.getElementById('addrStepLbl');
    addrLbl.querySelector('.sn').textContent = type.hasVehicle ? '3' : '2';
}

// ==========================================
// SELECTORS
// ==========================================
function selectType(id) {
    selectedType = id;
    renderTypes();
    updateLayout();
    hideResult();
    hideError();
}

function selectVehicle(id) {
    selectedVehicle = id;
    renderVehicles();
    hideResult();
}

function selectPacking(id) {
    selectedPacking = id;
    renderPackaging();
    hideResult();
}

// ==========================================
// GOOGLE MAPS
// ==========================================
const GOOGLE_MAPS_KEY = 'AIzaSyAsjRq5dOUsIamcrzvONHeBZtYuDKIu6U4';

async function loadGoogleMaps() {
    if (window.google && window.google.maps) return;

    return new Promise((resolve, reject) => {
        const s = document.createElement('script');
        s.src = `https://maps.googleapis.com/maps/api/js?key=${GOOGLE_MAPS_KEY}&libraries=places&language=he`;
        s.async = true;
        s.onload = resolve;
        s.onerror = reject;
        document.head.appendChild(s);
    });
}

function initAutocomplete() {
    const opts = { componentRestrictions: { country: 'il' }, fields: ['formatted_address','geometry'] };
    new google.maps.places.Autocomplete(document.getElementById('origin'), opts);
    new google.maps.places.Autocomplete(document.getElementById('destination'), opts);
}

function getDistance(origin, destination) {
    return new Promise((resolve, reject) => {
        const svc = new google.maps.DistanceMatrixService();
        svc.getDistanceMatrix({
            origins: [origin],
            destinations: [destination],
            travelMode: 'DRIVING',
            unitSystem: google.maps.UnitSystem.METRIC
        }, (res, status) => {
            if (status === 'OK' && res.rows[0].elements[0].status === 'OK') {
                const el = res.rows[0].elements[0];
                resolve({
                    km: el.distance.value / 1000,
                    distText: el.distance.text,
                    durText: el.duration.text
                });
            } else {
                reject(new Error('×œ× × ×™×ª×Ÿ ×œ××¦×•× ××¡×œ×•×œ ×‘×™×Ÿ ×”×›×ª×•×‘×•×ª. ×× × ×‘×“×•×§ ××ª ×”×›×ª×•×‘×•×ª.'));
            }
        });
    });
}

// ==========================================
// PRICING
// ==========================================
function calcPrice(distKm) {
    const type = DELIVERY_TYPES.find(t => t.id === selectedType);
    let base, perKm, includedKm;

    if (type.hasVehicle) {
        const veh = VEHICLES.find(v => v.id === selectedVehicle);
        base       = veh.base;
        perKm      = veh.perKm;
        includedKm = 0;
    } else {
        base       = type.base;
        perKm      = type.perKm;
        includedKm = type.includedKm;
    }

    const chargeableKm = Math.max(0, distKm - includedKm);
    const kmCost       = chargeableKm * perKm;
    const packCost     = type.hasVehicle ? PACKAGING.find(p => p.id === selectedPacking).price : 0;
    const subtotal     = base + kmCost + packCost;
    const vat          = subtotal * VAT;
    const total        = subtotal + vat;

    return { base, includedKm, chargeableKm, kmCost, packCost, subtotal, vat, total, perKm, distKm };
}

// ==========================================
// CALCULATE
// ==========================================
async function calculate() {
    const origin = document.getElementById('origin').value.trim();
    const dest   = document.getElementById('destination').value.trim();

    if (!origin || !dest) { showError('×× × ×”×›× ×¡ ×›×ª×•×‘×ª ××™×¡×•×£ ×•×›×ª×•×‘×ª ×™×¢×“'); return; }

    hideError();
    hideResult();
    setLoading(true);

    try {
        const dist  = await getDistance(origin, dest);
        const price = calcPrice(dist.km);
        showResult(dist, price);
    } catch (e) {
        showError(e.message || '×©×’×™××” ×‘×—×™×©×•×‘ ×”××¨×—×§. ×× × × ×¡×” ×©×•×‘.');
    } finally {
        setLoading(false);
    }
}

// ==========================================
// UI
// ==========================================
function setLoading(on) {
    const btn = document.getElementById('calcBtn');
    btn.disabled = on;
    btn.innerHTML = on ? '<div class="spinner"></div> ××—×©×‘...' : '×—×©×‘ ××—×™×¨';
}

function showError(msg) {
    const el = document.getElementById('errorBox');
    el.textContent = msg;
    el.classList.add('visible');
}
function hideError() {
    document.getElementById('errorBox').classList.remove('visible');
}

function showResult(dist, price) {
    const type = DELIVERY_TYPES.find(t => t.id === selectedType);
    let rows = '';

    // Type & vehicle
    rows += `<div class="res-row"><span class="rl">×¡×•×’ ××©×œ×•×—</span><span class="rv">${type.name}</span></div>`;
    if (type.hasVehicle) {
        const veh = VEHICLES.find(v => v.id === selectedVehicle);
        rows += `<div class="res-row"><span class="rl">×¡×•×’ ×¨×›×‘</span><span class="rv">${veh.name}</span></div>`;
    }

    // Distance & duration
    rows += `<div class="res-row"><span class="rl">××¨×—×§ × ×¡×™×¢×”</span><span class="rv">${dist.km.toFixed(1)} ×§"× (${dist.distText})</span></div>`;
    rows += `<div class="res-row"><span class="rl">×–××Ÿ ××©×•×¢×¨</span><span class="rv">${dist.durText}</span></div>`;

    // Base
    rows += `<div class="res-row"><span class="rl">××—×™×¨ ×‘×¡×™×¡</span><span class="rv">â‚ª${price.base.toFixed(0)}</span></div>`;

    // Included km
    if (price.includedKm > 0) {
        rows += `<div class="res-row"><span class="rl">×§"× ×›×œ×•×œ×™× ×‘××—×™×¨</span><span class="rv">${price.includedKm} ×§"×</span></div>`;
    }

    // Chargeable km
    if (price.chargeableKm > 0) {
        rows += `<div class="res-row"><span class="rl">×ª×•×¡×¤×ª ×§"×</span><span class="rv">â‚ª${price.kmCost.toFixed(2)} (${price.chargeableKm.toFixed(1)} ×§"× Ã— â‚ª${price.perKm})</span></div>`;
    } else if (price.includedKm > 0) {
        rows += `<div class="res-row"><span class="rl">×ª×•×¡×¤×ª ×§"×</span><span class="rv" style="color:var(--accent)">â‚ª0 (×‘×ª×•×š ×”×›×•×œ×œ)</span></div>`;
    }

    // Packaging
    if (price.packCost > 0) {
        const pk = PACKAGING.find(p => p.id === selectedPacking);
        rows += `<div class="res-row"><span class="rl">××¨×™×–×” (${pk.name})</span><span class="rv">â‚ª${price.packCost.toFixed(0)}</span></div>`;
    }

    // Subtotal
    rows += `<div class="res-row subtotal-row"><span class="rl">×¡×›×•× ×œ×¤× ×™ ××¢"×</span><span class="rv">â‚ª${price.subtotal.toFixed(2)}</span></div>`;
    rows += `<div class="res-row vat"><span class="rl">××¢"× (18%)</span><span class="rv">â‚ª${price.vat.toFixed(2)}</span></div>`;

    document.getElementById('resBody').innerHTML = rows;
    document.getElementById('totalPrice').textContent = `â‚ª${price.total.toFixed(2)}`;
    document.getElementById('resultPanel').classList.add('visible');
}

function hideResult() {
    document.getElementById('resultPanel').classList.remove('visible');
}

// ==========================================
// INIT
// ==========================================
renderTypes();
renderVehicles();
renderPackaging();
updateLayout();

loadGoogleMaps().then(initAutocomplete).catch(e => console.error('Google Maps:', e));
</script>
</body>
</html>
