<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#10b981">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/assets/logo.png">
    <link rel="apple-touch-icon" href="/assets/logo.png">
    <title>הצטרף כשליח ל-M.M.H</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;700&display=swap');
        * { font-family: 'Heebo', sans-serif; }
    </style>
</head>
<body class="bg-slate-900 text-white min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-2xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8">
                <img src="/assets/logo.png" alt="M.M.H Logo" class="h-32 w-auto mx-auto mb-4 object-contain animate-pulse">
                <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-purple-400 to-blue-500 bg-clip-text text-transparent">
                    הצטרף כשליח ל-M.M.H
                </h1>
                <p class="text-slate-400">מלא את הטופס ובואו להרוויח יחד</p>
            </div>

            <!-- Registration Form -->
            <form id="registrationForm" onsubmit="handleRegistration(event)" class="space-y-6">
                <!-- Personal Details -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                        👤 פרטים אישיים
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm mb-2">שם פרטי *</label>
                            <input type="text" id="firstName" required
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                        <div>
                            <label class="block text-sm mb-2">שם משפחה *</label>
                            <input type="text" id="lastName" required
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label class="block text-sm mb-2">תעודת זהות *</label>
                            <input type="text" id="idNumber" required pattern="[0-9]{9}"
                                   placeholder="123456789"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                        <div>
                            <label class="block text-sm mb-2">מין *</label>
                            <select id="gender" required
                                    class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                                <option value="">בחר...</option>
                                <option value="male">זכר</option>
                                <option value="female">נקבה</option>
                                <option value="other">אחר</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Contact Info -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                        📞 פרטי קשר
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm mb-2">מספר טלפון *</label>
                            <input type="tel" id="phone" required pattern="[0-9]{10}"
                                   placeholder="0501234567"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                        <div>
                            <label class="block text-sm mb-2">אימייל</label>
                            <input type="email" id="email"
                                   placeholder="example@gmail.com"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                        <div>
                            <label class="block text-sm mb-2">כתובת מגורים *</label>
                            <input type="text" id="address" required
                                   placeholder="רחוב, מספר, עיר"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                    </div>
                </div>

                <!-- Work Details -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                        🚗 פרטי עבודה
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm mb-2">איזור עבודה עיקרי *</label>
                            <select id="workArea" required
                                    class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                                <option value="">בחר איזור...</option>
                                <option value="center">מרכז</option>
                                <option value="north">צפון</option>
                                <option value="south">דרום</option>
                                <option value="jerusalem">ירושלים</option>
                                <option value="haifa">חיפה</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm mb-2">סוג רכב *</label>
                            <select id="vehicleType" required onchange="updateVehicleFields()"
                                    class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                                <option value="">בחר...</option>
                                <option value="bike">🏍️ אופנוע</option>
                                <option value="scooter">🛵 קטנוע</option>
                                <option value="car">🚗 רכב פרטי</option>
                                <option value="van">🚐 רכב מסחרי</option>
                                <option value="truck">🚚 משאית</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm mb-2">כתובת מענה מהירה *</label>
                            <input type="text" id="preferredAddress" required
                                   placeholder="רחוב, מספר, עיר - יהיה הכתובת שלך בווצאפ"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                            <p class="text-xs text-slate-400 mt-1">💡 לרכב מהיר - תקבל משלוחים בכתובת זאת ראשון</p>
                        </div>
                    </div>
                </div>

                <!-- Bank Details -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                        🏦 פרטי בנק
                    </h2>
                    <p class="text-sm text-slate-400 mb-4">לצורך העברת רווחים</p>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm mb-2">בנק</label>
                            <input type="text" id="bankNumber" pattern="[0-9]{2,3}"
                                   placeholder="12"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                        <div>
                            <label class="block text-sm mb-2">סניף</label>
                            <input type="text" id="branchNumber" pattern="[0-9]{3}"
                                   placeholder="456"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-sm mb-2">חשבון</label>
                            <input type="text" id="accountNumber" pattern="[0-9]{6,9}"
                                   placeholder="1234567"
                                   class="w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3">
                        </div>
                    </div>
                </div>

                <!-- Terms -->
                <div class="bg-slate-800 rounded-xl p-6 border border-slate-700">
                    <label class="flex items-start gap-3">
                        <input type="checkbox" id="terms" required class="mt-1 w-5 h-5">
                        <span class="text-sm">
                            אני מאשר/ת שקראתי והסכמתי ל<a href="#" class="text-blue-400 hover:underline">תנאי השימוש</a> 
                            ול<a href="#" class="text-blue-400 hover:underline">מדיניות הפרטיות</a> של M.M.H Delivery. 
                            אני מבין/ה שאני עובד/ת עצמאי/ת ואחראי/ת למס הכנסה ולביטוח לאומי.
                        </span>
                    </label>
                </div>

                <!-- Submit -->
                <div class="flex gap-4">
                    <button type="submit" 
                            class="flex-1 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 font-bold py-4 rounded-lg text-lg">
                        ✅ שלח בקשה להצטרפות
                    </button>
                    <a href="/courier" 
                       class="bg-slate-700 hover:bg-slate-600 px-6 py-4 rounded-lg font-bold">
                        ביטול
                    </a>
                </div>
            </form>

            <!-- Success Message -->
            <div id="successMessage" class="hidden mt-8 bg-emerald-500/20 border border-emerald-500 rounded-xl p-6 text-center">
                <div class="text-6xl mb-4">✅</div>
                <h3 class="text-2xl font-bold mb-2">הבקשה נשלחה בהצלחה!</h3>
                <p class="text-slate-300 mb-4">נבדוק את הפרטים ונחזור אליך בהקדם</p>
                <a href="/courier" class="inline-block bg-emerald-500 hover:bg-emerald-600 px-6 py-3 rounded-lg font-bold">
                    חזרה לכניסה
                </a>
            </div>

            <!-- Error Message -->
            <div id="errorMessage" class="hidden mt-4 bg-red-500/20 border border-red-500 rounded-lg p-4 text-center"></div>
        </div>
    </div>

    <script>
        async function handleRegistration(event) {
            event.preventDefault();
            
            const formData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                idNumber: document.getElementById('idNumber').value,
                gender: document.getElementById('gender').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                address: document.getElementById('address').value,
                workArea: document.getElementById('workArea').value,
                vehicleType: document.getElementById('vehicleType').value,
                preferredAddress: document.getElementById('preferredAddress').value,
                bankNumber: document.getElementById('bankNumber').value,
                branchNumber: document.getElementById('branchNumber').value,
                accountNumber: document.getElementById('accountNumber').value
            };
            
            try {
                const response = await fetch('/api/couriers/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    document.getElementById('registrationForm').classList.add('hidden');
                    document.getElementById('successMessage').classList.remove('hidden');
                } else {
                    const error = await response.json();
                    showError(error.error || 'שגיאה בשליחת הבקשה');
                }
            } catch (error) {
                console.error('Registration error:', error);
                showError('שגיאת תקשורת - נסה שוב');
            }
        }
        
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
            setTimeout(() => errorDiv.classList.add('hidden'), 5000);
        }
        
        function updateVehicleFields() {
            // Future: Show different fields based on vehicle type
        }
    </script>
</body>
</html>


